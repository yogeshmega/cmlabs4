var dashboardPostEditor=function(t){var e={};function n(o){if(e[o]){return e[o].exports}var a=e[o]={i:o,l:false,exports:{}};t[o].call(a.exports,a,a.exports,n);a.l=true;return a.exports}n.m=t;n.c=e;n.d=function(t,e,o){if(!n.o(t,e)){Object.defineProperty(t,e,{configurable:false,enumerable:true,get:o})}};n.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};n.d(e,"a",e);return e};n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};n.p="";return n(n.s=1)}([function(t,e){t.exports=window.tco},function(t,e,n){"use strict";var o=n(2);var a=c(o);var i=n(0);var r=c(i);var s=n(3);var d=c(s);function c(t){return t&&t.__esModule?t:{default:t}}var u=window.wp;(0,a.default)(function(){var t=window.csDashboardPostEditorData;var e=window._;function n(e){return t.strings[e]||""}var o=(0,a.default)("body");var i=(0,a.default)(t.editorTabMarkup);var s=(0,a.default)(t.editorTabContentMarkup);var c=(0,a.default)("#postdivrich");var l=(0,a.default)('<div style="display: inline-flex;align-items: center;"><button type="button"  class="components-button is-button is-default is-large">'+n("edit-with-wordpress")+"</button></div>");var f=(0,a.default)('<button type="button" data-cs-switch-button class="components-button is-primary is-button is-default is-large">'+n("edit-with-cornerstone")+"</button>");c.after(i);c.find(".wp-editor-tabs").append((0,a.default)('<button type="button" data-cs-switch-button id="content-cornerstone" class="wp-switch-editor switch-cornerstone">'+n("cornerstone-tab")+"</button>"));setTimeout(function(){return(0,a.default)("#editor .edit-post-header-toolbar").append(f)},1);function p(){c.hide();i.show();(0,a.default)("#editor .edit-post-header__settings").hide();(0,a.default)("#editor .edit-post-visual-editor").hide().before(s);(0,a.default)("#editor .edit-post-header-toolbar").before(l).hide();(0,a.default)("#editor .edit-post-header__settings").hide();f.detach();try{u.data.dispatch("core/edit-post").closeGeneralSidebar()}catch(t){}}i.find("#content-tmce, #content-html").click(function(){var t=-1!==(0,a.default)(this).attr("id").indexOf("html");w(function(){c.show();(0,a.default)(window).trigger("scroll.editor-expand","scroll");i.hide();window.switchEditors.go("content",t?"html":"tmco")})});l.on("click","button",function(t){w(function(){(0,a.default)("#editor .edit-post-visual-editor").show();l.detach();s.detach();(0,a.default)("#editor .edit-post-header__settings").show();(0,a.default)("#editor .edit-post-header-toolbar").show().append(f)})});function w(e){if("true"===t.usesCornerstone){r.default.confirm({message:n("manual-edit-warning"),acceptClass:"tco-btn-nope",acceptBtn:n("manual-edit-accept"),declineBtn:n("manual-edit-decline"),accept:function n(){if("new"!==t.post_id){u.ajax.post("cs_override",{post_id:t.post_id,_cs_nonce:t._cs_nonce})}t.usesCornerstone="false";e()}});return}e()}o.on("click keydown","[data-cs-switch-button]",function(){if("false"===t.usesCornerstone&&"new"!==t.post_id&&u.autosave&&""!==u.autosave.getPostData().content){r.default.confirm({message:n("overwrite-warning"),acceptClass:"tco-btn-nope",acceptBtn:n("overwrite-accept"),declineBtn:n("overwrite-decline"),accept:function e(){t.usesCornerstone="none";p()}});return}p()});if("true"===t.usesCornerstone)setTimeout(p,1);o.on("click","[data-cs-edit-button]",function(t){t.preventDefault();t.stopPropagation();if(window.wp.autosave&&window.wp.autosave.getPostData)h();if(window.wp.data&&window.wp.data.select)b()});var v=function e(n){return window.location=t.editURL.replace("{{post_id}}",n)};function h(){var t=window.wp.autosave.getPostData(),e=t.post_id,o=t.auto_draft;if(!e)return;if(!o)return v(e);(0,a.default)("#title-prompt-text").hide();var i=(0,a.default)("#title");var r=i.val();if(!r||"title"===r)i.val(n("default-title"));u.autosave.server.triggerSave();(0,a.default)(document).on("heartbeat-tick.autosave",function(){var t=u.autosave.getPostData();(0,a.default)(window).off("beforeunload.edit-post");v(t.post_id)})}function b(){try{var t=u.data.select("core/editor");var e=t.getCurrentPostId();if(!e)return;if(!t.isCleanNewPost())return v(e);var o=u.data.dispatch("core/editor");if(!t.getCurrentPostAttribute("title"))o.editPost({title:n("default-title")});o.savePost();var a=setInterval(function(){try{if(false===u.data.select("core/editor").isSavingPost()){clearInterval(a);v(e)}}catch(t){console.warn("Unable to launch Content Builder from Gutenburg",t);clearInterval(a)}},100)}catch(t){console.warn("Unable to launch Content Builder from Gutenburg",t)}}if(window.YoastSEO)setTimeout(d.default,0)})},function(t,e){t.exports=window.jQuery},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:true});e.default=function(){var t=r().match(/\[cs_content.*?\[\/cs_content\]/gi);if(!window.YoastSEO||!t){return}window.YoastSEO.app.registerPlugin("csContent",{status:"loading"});window.YoastSEO.app.registerPlugin("csContentPre",{status:"ready"});window.YoastSEO.app.registerModification("content",o,"csContentPre");var e=t.map(function(t){return t.replace("[cs_content]",'[cs_content _p="'+window.csDashboardPostEditorData.post_id+'" no_wrap=true]')});a.default.ajax({data:{content:e},action:"cs_yoast_do_shortcode",_cs_nonce:window.csDashboardPostEditorData._cs_nonce,done:function t(e){var o=e.content;n=o;window.YoastSEO.app.pluginReady("csContent");window.YoastSEO.app.registerModification("content",i,"csContent",100)},fail:function t(e){console.warn("Unable to process content builder shortcodes for Yoast",e);window.YoastSEO.app.pluginReady("csContent")}});var n=[];function o(e){if(t){t.forEach(function(t,n){e=e.replace(t,"\x3c!--cs-content-yoast-"+n+"--\x3e")})}return e}function i(t){var e=t.match(/<!--cs-content-yoast-\d-->/gi);if(e){e.forEach(function(e){var o=parseInt(e.replace("\x3c!--cs-content-yoast-","").replace("--\x3e",""));if(!isNaN(o)&&undefined!==n[o]){t=t.replace(e,n[o])}})}return t}};var o=n(0);var a=i(o);function i(t){return t&&t.__esModule?t:{default:t}}function r(){var t=window.document.getElementById("content")&&window.document.getElementById("content").value||"";if(typeof window.tinyMCE!=="undefined"&&typeof window.tinyMCE.editors!=="undefined"&&window.tinyMCE.editors.length!==0){t=window.tinyMCE.get("content")&&window.tinyMCE.get("content").getContent()||""}return t}}]);
//# sourceMappingURL=dashboard-post-editor.js.map